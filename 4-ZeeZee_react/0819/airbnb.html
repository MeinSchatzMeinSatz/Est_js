<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Airbnb 실습</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.2.0/redux.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }

      .filter-btn {
        padding: 8px 16px;
        margin: 5px;
        border: 2px solid #ddd;
        background: white;
        cursor: pointer;
      }

      .filter-btn.active {
        background: #ff5a5f;
        color: white;
      }

      .listing {
        border: 3px solid #ddd;
        padding: 15px;
        margin: 10px 0;
      }

      .listing.hidden {
        display: none;
      }

      .amenity {
        display: inline-block;
        background-color: #f0f0f0;
        padding: 2px 6px;
        margin: 2px;
        font-size: 12px;
      }

      .amenity.highlight {
        background: #ff5a5f;
        color: white;
      }
    </style>
  </head>
  <body>
    <h1>Redux Airbnb 필터링</h1>

    <div>
      <h3>편의시설 필터:</h3>
      <button class="filter-btn" onclick="toggleFilter('무료 주차 공간')">
        무료 주차 공간
      </button>
      <button class="filter-btn" onclick="toggleFilter('대형 욕조')">
        대형 욕조
      </button>
      <button class="filter-btn" onclick="toggleFilter('바베큐 그릴')">
        바베큐 그릴
      </button>
      <button class="filter-btn" onclick="toggleFilter('게스트용 별채')">
        게스트용 별채
      </button>
      <button class="filter-btn" onclick="toggleFilter('수영장')">
        수영장
      </button>
      <button class="filter-btn" onclick="toggleFilter('주방')">주방</button>
      <button class="filter-btn" onclick="toggleFilter('TV')">TV</button>
    </div>

    <div id="resultInfo"></div>

    <div id="listingContainer">
      <!-- 숙소 목록이 여기에 렌더링 -->
    </div>

    <script>
      // 샘플 데이터
      const listings = [
        {
          id: 1,
          title: "도심 아파트",
          location: "강남구",
          price: "85,000원",
          amenities: ["무료 주차 공간", "주방", "TV"],
        },
        {
          id: 2,
          title: "럭셔리 펜트하우스",
          location: "한남동",
          price: "250,000원",
          amenities: ["대형 욕조", "수영장", "게스트용 별채", "주방", "TV"],
        },
        {
          id: 3,
          title: "바다뷰 펜션",
          location: "해운대",
          price: "120,000원",
          amenities: ["바베큐 그릴", "주방", "무료 주차 공간"],
        },
        {
          id: 4,
          title: "산속 별장",
          location: "평창",
          price: "95,000원",
          amenities: ["바베큐 그릴", "게스트용 별채", "무료 주차 공간", "TV"],
        },
        {
          id: 5,
          title: "모던 스튜디오",
          location: "홍대",
          price: "65,000원",
          amenities: ["주방", "TV"],
        },
        {
          id: 6,
          title: "리조트 빌라",
          location: "제주도",
          price: "180,000원",
          amenities: [
            "수영장",
            "대형 욕조",
            "바베큐 그릴",
            "무료 주차 공간",
            "주방",
            "TV",
          ],
        },
      ];

      // Redux 스토어 생성
      const store = Redux.createStore(reducer);

      // reducer
      function reducer(state, action) {
        console.log("Redux Action:", action); // Redux 액션 로깅

        if (state === undefined) {
          return {
            listing: listings,
            activeFilters: [],
            filteredListings: listings,
          };
        }

        if (action.type === "TOGGLE_FILTER") {
          const newFilters = state.activeFilters.includes(action.filter)
            ? state.activeFilters.filter((f) => f !== action.filter)
            : [...state.activeFilters, action.filter];

          const filteredListings =
            newFilters.length === 0
              ? state.listings
              : state.listings.filter((listing) =>
                  newFilter.every((filter) => listing.amnities.includes(filter))
                );

          return {
            ...state,
            activeFilter: newFilters,
            filteredListings: filteredListings,
          };
        }

        return state;
      }

      // 액션 디스패치
      function toggleFilter(filter) {
        store.dispatch({ type: "TOGGLE_FILTER", filter: filter });
      }

      // UI 업데잍 함수들
      function updateUI() {
        const state = store.getState();
        console.log("Current State:", state);
      }
    </script>
  </body>
</html>
